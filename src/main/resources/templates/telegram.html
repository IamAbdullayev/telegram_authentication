<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Telegram Auth</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>======== WELCOME ========</h1>
    <p id="user-info"></p>

    <script>
        fetch("/auth/telegram", {
            method: "POST",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded"
            },
            body: "initData=" + encodeURIComponent(window.Telegram.WebApp.initData)
        })
        .then(response => response.json())
        .then(responseData => {
            console.log("Ответ сервера:", responseData);

            document.getElementById("user-info").innerHTML =
                "<h2>Привет, " + responseData.firstName + "!</h2>" +
                "<p>Username: @" + responseData.username + "</p>" +
                "<p>ID: " + responseData.id + "</p>" +
                (responseData.photoUrl ? "<img src='" + responseData.photoUrl + "' alt='avatar' width='100'/>" : "");

        })
        .catch(error => {
            document.getElementById("user-info").innerText = "Ошибка при авторизации.";
        });
    </script>
</body>
</html>